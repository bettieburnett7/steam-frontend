<script>
// Your deployed proxy
const BASE = 'https://steam-proxy-l78k.onrender.com';

// Utility: escape JSON when injecting into HTML
function escapeHtml(s) {
return s.replace(/[&<>"']/g, m => ({
'&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
}[m]));
}

async function call(path) {
const out = document.getElementById('out');
out.textContent = 'Loading…';

try {
const r = await fetch(path, { headers: { 'Accept': 'application/json' } });
if (!r.ok) {
const txt = await r.text().catch(() => '');
throw new Error(`${r.status} ${r.statusText}${txt ? ' — ' + txt : ''}`);
}
const data = await r.json();

// Pretty render profile
if (path.includes('/steam/profile')) {
const p = data?.response?.players?.[0];
if (p) {
out.innerHTML = `
<div style="display:flex;gap:12px;align-items:center">
<img src="${p.avatarmedium}" alt="" width="64" height="64">
<div>
<div style="font-weight:600">${p.personaname ?? ''}</div>
<a href="${p.profileurl}" target="_blank" rel="noopener">Open Steam profile</a>
</div>
</div>
<pre style="margin-top:12px">${escapeHtml(JSON.stringify(p, null, 2))}</pre>
`;
return;
}
}

// Default: show full JSON
out.textContent = JSON.stringify(data, null, 2);
} catch (e) {
out.textContent = 'Error: ' + e.message;
}
}

// Attach event listeners
document.getElementById('btnProfile').addEventListener('click', () => {
const id = document.getElementById('steamid').value.trim();
if (!id) { alert('Enter a Steam64 ID'); return; }
call(`${BASE}/steam/profile?steamid=${encodeURIComponent(id)}`);
});

document.getElementById('btnGames').addEventListener('click', () => {
const id = document.getElementById('steamid').value.trim();
if (!id) { alert('Enter a Steam64 ID'); return; }
call(`${BASE}/steam/owned-games?steamid=${encodeURIComponent(id)}`);
});
</script>


	






