<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Steam Profile Lookup</title>
<style>
body { font-family: system-ui, sans-serif; max-width: 800px; margin: 40px auto; }
.input-section { text-align: center; margin-bottom: 16px; }
input, button { font-size: 16px; padding: 8px; }
.card { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,.08); padding: 16px; display:none; }
.row { display:flex; gap:12px; align-items:center; }
.avatar { width: 64px; height: 64px; border-radius: 8px; }
#out { background:#f6f8fa; padding:12px; overflow:auto; }
</style>
</head>
<body>
<h1>Steam Profile Lookup</h1>

<div class="input-section">
<label>Steam64 ID:
<input id="steamid" size="20" placeholder="7656…">
</label>
<button id="btnProfile">Get Profile</button>
<button id="btnGames">Get Owned Games</button>
</div>

<!-- Pretty profile card -->
<div id="profileCard" class="card">
<div class="row">
<img id="avatar" class="avatar" src="" alt="Steam Avatar">
<div>
<div id="username" style="font-weight:600"></div>
<a id="profileLink" href="#" target="_blank" rel="noopener">Open Steam profile</a>
</div>
</div>
<div id="gameCount" style="margin-top:8px"></div>
</div>

<!-- Games Grid -->
<div id="games" class="grid"></div>

<!-- Fallback / debug JSON output -->
<h2>Result</h2>
<pre id="out">—</pre>

<script>
const BASE = 'https://steam-proxy-178k.onrender.com';

// Escape HTML safely
function escapeHTML(s) {
return s.replace(/[<>&"']/g, m =>
({ '<': '&lt;', '>': '&gt;', '&': '&amp;', '"': '&quot;', "'": '&#39;' }[m])
);
}

// Core fetch + render
async function call(path) {
const out = document.getElementById('out');
const card = document.getElementById('profileCard');
const gamesContainer = document.getElementById('games');

out.textContent = 'Loading…';
if (card) card.style.display = 'none';
if (gamesContainer) gamesContainer.innerHTML = '';

try {
const r = await fetch(path, { headers: { 'Accept': 'application/json' } });
if (!r.ok) throw new Error(`HTTP ${r.status} - ${r.statusText}`);
const data = await r.json();

// ----- Profile -----
if (path.includes('/steam/profile')) {
const p = data.response?.players?.[0];
if (!p) throw new Error('No profile found');

document.getElementById('avatar').src =
p.avatarmedium || p.avatarfull || p.avatar || '';
document.getElementById('username').textContent =
p.personaname || '(unknown)';
document.getElementById('profileLink').href = p.profileurl || '#';

card.style.display = 'block';
out.textContent = JSON.stringify(p, null, 2);
return;
}

// ----- Owned games -----
if (path.includes('/steam/owned-games')) {
const count = data.response?.game_count ?? 0;
document.getElementById('gameCount').textContent = `Owned games: ${count}`;

const games = data.response?.games || [];
if (!games.length) {
gamesContainer.innerHTML = '<p>No games found for this Steam account.</p>';
out.textContent = JSON.stringify(data, null, 2);
return;
}

gamesContainer.innerHTML = games.map(g => `
<div class="game">
<img src="https://cdn.cloudflare.steamstatic.com/steam/apps/${g.appid}/header.jpg"
alt="${escapeHTML(g.name)}" width="200">
<p>${escapeHTML(g.name)}</p>
</div>
`).join('');

out.textContent = JSON.stringify(data, null, 2);
return;
}
} catch (e) {
console.error(e);
out.textContent = `Error: ${e.message}`;
}
}

// ----- Buttons -----
document.getElementById('btnProfile').addEventListener('click', () => {
const id = document.getElementById('steamid').value.trim();
if (!id) return alert('Please enter a Steam64 ID!');
call(`${BASE}/steam/profile?steamid=${encodeURIComponent(id)}`);
});

document.getElementById('btnGames').addEventListener('click', () => {
const id = document.getElementById('steamid').value.trim();
if (!id) return alert('Please enter a Steam64 ID!');
call(`${BASE}/steam/owned-games?steamid=${encodeURIComponent(id)}`);
});
</script>


	






