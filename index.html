<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Steam Profile Lookup</title>
<style>
body { font-family: system-ui, sans-serif; max-width: 800px; margin: 40px auto; }
.input-section { text-align: center; margin-bottom: 16px; }
input, button { font-size: 16px; padding: 8px; }
.card { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,.08); padding: 16px; display:none; }
.row { display:flex; gap:12px; align-items:center; }
.avatar { width: 64px; height: 64px; border-radius: 8px; }
#out { background:#f6f8fa; padding:12px; overflow:auto; }
</style>
</head>
<body>
<h1>Steam Profile Lookup</h1>

<div class="input-section">
<label>Steam64 ID:
<input id="steamid" size="20" placeholder="7656…">
</label>
<button id="btnProfile">Get Profile</button>
<button id="btnGames">Get Owned Games</button>
</div>

<!-- Pretty profile card -->
<div id="profileCard" class="card">
<div class="row">
<img id="avatar" class="avatar" src="" alt="Steam Avatar">
<div>
<div id="username" style="font-weight:600"></div>
<a id="profileLink" href="#" target="_blank" rel="noopener">Open Steam profile</a>
</div>
</div>
<div id="gameCount" style="margin-top:8px"></div>
</div>

<!-- Fallback / debug JSON output -->
<h2>Result</h2>
<pre id="out">—</pre>

<script>
// Your deployed proxy
const BASE = 'https://steam-proxy-l78k.onrender.com';

// Utility: escape JSON when injecting into HTML
function escapeHTML(s) {
return s.replace(/[<>&"']/g, m => (
m === '&' ? '&amp;' : m === '<' ? '&lt;' : m === '>' ? '&gt;' :
m === '"' ? '&quot;' : '&#39;'
));
}

async function call(path) {
const out = document.getElementById('out');
const card = document.getElementById('profileCard');
out.textContent = 'Loading…';
card.style.display = 'none';

try {
const r = await fetch(path, { headers: { 'Accept': 'application/json' } });
const txt = await r.text().catch(()=>'');
if (!r.ok) throw new Error(`${r.status} ${r.statusText}${txt ? ' – ' + txt : ''}`);
const data = await JSON.parse(txt);

// Pretty render profile
if (path.includes('/steam/profile')) {
const p = data?.response?.players?.[0];
if (!p) throw new Error('No profile found');
document.getElementById('avatar').src = p.avatarmedium || p.avatarfull || p.avatar;
document.getElementById('username').textContent = p.personaname || '(unknown)';
document.getElementById('profileLink').href = p.profileurl || '#';
card.style.display = 'block';
out.textContent = JSON.stringify(p, null, 2);
return;
}

// Owned games summary
if (path.includes('/steam/owned-games')) {
const count = data?.response?.game_count ?? 0;
document.getElementById('gameCount').textContent = `Owned games: ${count}`;
document.getElementById('profileCard').style.display = 'block';
out.textContent = JSON.stringify(data, null, 2);
return;
}

// Default: show full JSON
out.textContent = JSON.stringify(data, null, 2);
} catch (e) {
out.textContent = 'Error: ' + e.message;
}
}

// Attach event listeners
document.getElementById('btnProfile').addEventListener('click', () => {
const id = document.getElementById('steamid').value.trim();
if (!id) { alert('Enter a Steam64 ID'); return; }
call(`${BASE}/steam/profile?steamid=${encodeURIComponent(id)}`);
});

document.getElementById('btnGames').addEventListener('click', () => {
const id = document.getElementById('steamid').value.trim();
if (!id) { alert('Enter a Steam64 ID'); return; }
call(`${BASE}/steam/owned-games?steamid=${encodeURIComponent(id)}`);
});
</script>
</body>
</html>


	






