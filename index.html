<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta
name="viewport"
content="width=device-width, initial-scale=1, viewport-fit=cover"
/>
<title>Steam Profile Lookup</title>
<style>
:root { --bg:#f6f8fa; --card:#fff; --text:#111; --muted:#666; --brand:#2563eb; --border:#e5e7eb; }
* { box-sizing: border-box; }
body {
margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
background: var(--bg); color: var(--text);
}
.wrap { max-width: 980px; margin: 32px auto; padding: 0 16px; }
h1 { margin: 0 0 16px; font-size: clamp(20px, 4vw, 32px); }

.controls {
display: grid; grid-template-columns: 1fr auto auto; gap: 8px;
align-items: center; margin-bottom: 16px;
}
input[type="text"]{
padding: 12px 14px; border: 1px solid var(--border); border-radius: 10px;
font-size: 16px; width: 100%; background: #fff;
}
button{
padding: 12px 14px; border-radius: 10px; border: 1px solid var(--border);
background: var(--card); cursor: pointer; font-weight: 600;
}
button:hover{ background:#f0f4ff; border-color:#c7d2fe; }

/* Profile card */
.card{
display:none;
background: var(--card); border: 1px solid var(--border); border-radius: 14px;
padding: 14px; margin: 12px 0;
}
.row{ display:flex; align-items:center; gap:12px; }
.avatar{ width:64px; height:64px; border-radius: 10px; background:#ddd; }
.username{ font-weight:700; }
.muted{ color: var(--muted); }

/* Games */
#gameCount{ margin-top: 10px; font-weight: 600; }
#games{
margin-top: 10px; display:grid; gap: 10px;
grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
}
.game{
background: var(--card); border: 1px solid var(--border); border-radius: 12px;
padding: 10px; text-align: center;
}
.game img{ width:100%; height:auto; border-radius: 8px; display:block; }
.game p{ margin:8px 0 0; font-size: 14px; }

/* Result/debug area */
#out{
white-space: pre-wrap; overflow:auto; background: var(--card);
border: 1px solid var(--border); border-radius: 12px;
padding: 12px; margin-top: 16px; min-height: 44px;
}

@media (max-width: 640px){
.controls{ grid-template-columns: 1fr; }
button{ width:100%; }
.row{ align-items:flex-start; }
}
</style>
</head>
<body>
<div class="wrap">
<h1>Steam Profile Lookup</h1>

<div class="controls">
<input id="steamid" type="text" placeholder="Steam64 (17 digits), vanity name, or full profile URL" />
<button id="btnProfile">Get Profile</button>
<button id="btnGames">Get Owned Games</button>
</div>

<!-- Profile card -->
<div id="profileCard" class="card">
<div class="row">
<img id="avatar" class="avatar" src="" alt="Steam Avatar" />
<div>
<div id="username" class="username"></div>
<a id="profileLink" class="muted" href="#" target="_blank" rel="noopener">Open Steam profile</a>
</div>
</div>
<div id="gameCount"></div>
</div>

<!-- Games grid -->
<div id="games"></div>

<!-- Debug output -->
<div id="out">-</div>
</div>

<script>
// Your deployed proxy (change here if your proxy URL changes)
const BASE = 'https://steam-proxy-l78k.onrender.com';

// escape when dumping text into HTML
const escapeHTML = s => String(s).replace(/[<>&"']/g, m => ({
'<':'&lt;', '>':'&gt;', '&':'&amp;', '"':'&quot;', "'":'&#39;'
}[m]));

// Resolve whatever the user typed (Steam64, vanity, or full URL) to a 64-bit SteamID
async function getSteamIdFromInput() {
const raw = document.getElementById('steamid').value.trim();
if (!raw) throw new Error('Enter a Steam64 ID, a vanity name, or a Steam profile URL.');

// already a Steam64?
if (/^\d{17}$/.test(raw)) return raw;

// ask our proxy to resolve vanity/profile URL
const url = `${BASE}/steam/resolve?v=${encodeURIComponent(raw)}`;
const r = await fetch(url, { headers: { Accept: 'application/json' }});
if (!r.ok) throw new Error(`Resolve failed: ${r.status} ${await r.text()}`);
const data = await r.json();
const steamid = data?.response?.steamid;
if (!steamid) throw new Error('Could not resolve that value to a SteamID.');
return steamid;
}

async function fetchProfile() {
const out = document.getElementById('out');
const card = document.getElementById('profileCard');
const grid = document.getElementById('games');
out.textContent = 'Loading profile...';
grid.innerHTML = '';
card.style.display = 'none';

try {
const steamid = await getSteamIdFromInput();
const r = await fetch(`${BASE}/steam/profile?steamid=${encodeURIComponent(steamid)}`, {
headers: { Accept: 'application/json' }
});
if (!r.ok) throw new Error(`HTTP ${r.status}: ${await r.text()}`);
const data = await r.json();
const p = data?.response?.players?.[0];
if (!p) throw new Error('No profile found.');

document.getElementById('avatar').src = p.avatarmedium || p.avatarfull || p.avatar || '';
document.getElementById('username').textContent = p.personaname || '(unknown)';
document.getElementById('profileLink').href = p.profileurl || '#';
card.style.display = 'block';

out.textContent = JSON.stringify(p, null, 2);
} catch (e) {
out.textContent = `Error: ${e.message}`;
}
}

async function fetchOwnedGames() {
const out = document.getElementById('out');
const grid = document.getElementById('games');
const count = document.getElementById('gameCount');
out.textContent = 'Loading owned games...';
grid.innerHTML = '';
count.textContent = '';

try {
const steamid = await getSteamIdFromInput();
const r = await fetch(`${BASE}/steam/owned-games?steamid=${encodeURIComponent(steamid)}`, {
headers: { Accept: 'application/json' }
});
if (!r.ok) throw new Error(`HTTP ${r.status}: ${await r.text()}`);
const data = await r.json();

const games = data?.response?.games || [];
const total = data?.response?.game_count ?? games.length;
count.textContent = `Owned games: ${total}`;

if (!games.length) {
out.textContent = 'No games found for this account.';
return;
}

grid.innerHTML = games.map(g => `
<div class="game">
<img src="https://cdn.cloudflare.steamstatic.com/steam/apps/${g.appid}/header.jpg" alt="">
<p>${escapeHTML(g.name)}</p>
</div>
`).join('');

out.textContent = JSON.stringify({ game_count: total }, null, 2);
} catch (e) {
out.textContent = `Error: ${e.message}`;
}
}

document.getElementById('btnProfile').addEventListener('click', fetchProfile);
document.getElementById('btnGames').addEventListener('click', fetchOwnedGames);
</script>
</body>
</html>


	






